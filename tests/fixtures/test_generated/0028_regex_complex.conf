# Complex regex patterns
worker_processes auto;

events {
    worker_connections 1024;
}

http {
    server {
        listen 80;
        server_name regex.example.com;

        # Version with optional patch
        location ~ ^/api/v([0-9]+)\.([0-9]+)(\.([0-9]+))?/ {
            proxy_pass http://127.0.0.1:8080;
        }

        # Date pattern
        location ~ ^/archive/([0-9]{4})/([0-9]{2})/([0-9]{2})/ {
            root /var/archive;
        }

        # Semantic versioning
        location ~ ^/pkg/[a-z]+-[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.tar\.gz$ {
            root /var/packages;
        }

        # IP-like pattern (for testing)
        location ~ ^/ip/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ {
            return 200 "IP pattern";
        }

        # Complex file pattern
        location ~ ^/assets/[a-z]+\.[a-f0-9]{8}\.(js|css)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
}
