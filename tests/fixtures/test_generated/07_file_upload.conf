# Large file upload handling
worker_processes auto;

events {
    worker_connections 1024;
}

http {
    client_max_body_size 100m;
    client_body_buffer_size 128k;
    client_body_timeout 300s;
    client_header_timeout 60s;

    proxy_request_buffering off;
    proxy_buffering off;

    server {
        listen 80;
        server_name upload.example.com;

        location /upload {
            client_max_body_size 500m;
            client_body_temp_path /var/tmp/nginx/upload 1 2;

            proxy_pass http://127.0.0.1:8080;
            proxy_connect_timeout 300s;
            proxy_send_timeout 300s;
            proxy_read_timeout 300s;
        }

        location / {
            root /var/www/html;
            index index.html;
        }
    }
}
